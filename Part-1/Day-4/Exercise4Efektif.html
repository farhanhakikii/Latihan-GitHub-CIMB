<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  
</body>
<script>
  let arrItemNames = ['Jeruk', 'Mangga', 'Apel']
  let arrPrice = [10000, 7000, 13000]
  let arrStock = [10, 10, 10]
  let arrInputs = [0, 0, 0]
  let inputUserMenu;
  let inputUserMenuIndex;
  let inputUserQty;
  let isRepeat;
  let totalPrice;
  let userPayment;

  let menu = ''

  

  do {

    menu = ''

    for (let i = 0; i < arrItemNames.length; i++) {
      menu += `${i + 1}. ${arrItemNames[i]} IDR ${arrPrice[i]}/pcs (${arrStock[i]} items in stock)\n`
    }

    menu += `${arrItemNames.length + 1}. Checkout`

    inputUserMenu = prompt(menu)
    inputUserMenuIndex = inputUserMenu - 1
  
    if (inputUserMenu == arrItemNames.length + 1) {
      totalPrice = 0

      for (let i = 0; i < arrItemNames.length; i++) {
        totalPrice += arrPrice[i] * arrInputs[i]
      }

      do {
        userPayment = prompt(`Total belanjaan anda sebesar IDR ${totalPrice}`)
  
        if (userPayment > totalPrice) {
          alert(`Kembalian anda IDR ${userPayment - totalPrice}`)
          isRepeat = false
        } else if (userPayment < totalPrice) {
          alert(`Uang anda kurang IDR ${totalPrice - userPayment}`)
          isRepeat = true
        } else if (userPayment == totalPrice) {
          alert('Terima kasih sudah membayar dengan uang pas')
          isRepeat = false
        }
      } while(isRepeat)

      for (let i = 0; i < arrInputs.length; i++) {
        arrStock[i] -= arrInputs[i]
        arrInputs[i] = 0
      }
      isRepeat = confirm('Belanja lagi gak?')

    } else {
      do {
        inputUserQty = parseInt(prompt(`Mau beli berapa ${arrItemNames[inputUserMenuIndex]}?`))
  
        if (arrStock[inputUserMenuIndex] >= (inputUserQty + arrInputs[inputUserMenuIndex])) {
          arrInputs[inputUserMenuIndex] += inputUserQty
          isRepeat = false
        } else {
          alert(`Stock ${arrItemNames[inputUserMenuIndex]} tidak cukup`)
          isRepeat = true
        }
  
      } while(isRepeat)

      isRepeat = true
    }
  } while(isRepeat)

//Backup Exercise 5
// let dataorg = [
//     {
//         buah: 'Mangga',
//         stok: 100,
//         harga: 7000,
//         qty: 0
//     },{
//         buah: 'Jeruk',
//         stok: 300,
//         harga: 3000,
//         qty: 0
//     },{
//         buah: 'Pisang',
//         stok: 200,
//         harga: 5000,
//         qty: 0
//     }]
//     let ulang

//     do{
//         let menu = ''
//         menu = `Daftar Menu:\n`
//         for(i = 0; i < dataorg.length; i++){
//             menu += `${i+1}. ${dataorg[i].buah} Rp.${dataorg[i].harga}/pcs. Stok tersedia ${dataorg[i].stok}.\n`
//         }
//         menu += `${dataorg.length+1}. Checkout`
//         daftmenu = parseInt(prompt(menu))
//         index = daftmenu - 1
//         if(daftmenu == dataorg.length+1){
//             totalprice = 0
//             for(i = 0; i < dataorg.length; i++){
//                 totalprice += dataorg[i].harga*dataorg[i].qty
//             }
//                 checkout = `Daftar Belanjaan Anda :\nNo.\tItem\tJumlah\n`
//                 count = 1
//                 for(i = 0;i < dataorg.length; i++){
//                     checkout += `${count}\t${dataorg[i].buah}\t${dataorg[i].qty}\n`
//                     count += 1
//                 }
//                 checkout += `Total Pembelian Rp.${totalprice}\n`
//                 keranjang = parseInt(confirm(checkout))
//                 if(keranjang == true){
//                     ulang = false
//                 }else{
//                     ulang = true
//                 }                
//             do{ 

//                 bayar = parseInt(prompt(`Total Belanja Anda ${totalprice}\nSilahkan Masukkan Uang Anda`))
//                 if(bayar > totalprice){
//                     alert(`Kembalian anda ${bayar - totalprice}`)
//                     ulang = false
//                 }else if(bayar == totalprice){
//                     alert(`Terimakasih sudah membayar dengan uang pas.`)
//                     ulang = false
//                 }else{
//                     alert(`Uang anda kurang ${totalprice - bayar}`)
//                     ulang = true
//                 }
//             }while(ulang == true)

//             for (i = 0; i < dataorg.length; i++) {
//             dataorg[i].stok -= dataorg[i].qty
//             dataorg[i].qty = 0
//             }
//             ulang = confirm('Mau Belanja Lagi?')

//         }else{
//             do{
//             inputan = parseInt(prompt(`Mau beli berapa ${dataorg[index].buah}`))
//             if(inputan > dataorg[index].stok || inputan < 0){
//                 alert(`Stok ${dataorg[index].buah} tidak cukup atau anda memasukkan angka yang salah.`)
//                 ulang = true
//             }else{
//                 dataorg[index].qty += inputan
//                 ulang = false
//                  }
//             }while(ulang == true)
//             ulang = true
//         }
//     }while(ulang == true)

</script>
</html>